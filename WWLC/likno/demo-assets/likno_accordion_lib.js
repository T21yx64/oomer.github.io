// Likno Web Accordion Builder Libraries 1.0.1
// Copyright (c) Likno Software 2008-2011

// This code is property of Likno Software. It must be produced by a licensed Likno Web Accordion Builder and used on *web servers* only (Internet/Intranet websites).
// It *cannot* be used for distributable implementations (demos, applications or CD-based webs), unless a *Distributed Application" license is purchased.
// Any unauthorized use, reverse-engineering, alteration or copying of any means (electronic or not) is strictly prohibited.
// ***Removal of the present copyright notice and license terms is strictly prohibited***

;(function($){$.liknoAccordion=function(options){return new LiknoAccordion("",options)};$.fn.liknoAccordion=function(options){return new LiknoAccordion(this,options)};$.liknoAccordion.defaults={direction:"top",loadingHeaderImages:false,dependentPanes:false,allowAllClosed:false,fixedHeight:true,getFocus:false,isFloating:false,singleContainer:false,zIndex:1,positioning:{type:0,selector:"",drifty:false,elementCorner:0,accordionCorner:0,posX:0,posY:0},classes:{accordionClass:'liknoaccordion',containerClass:'liknoaccordion_container',paneContainerClass:'liknoaccordion_pane',headerClass:'liknoaccordion_header',separatorClass:'liknoaccordion_separator',bodyClass:'liknoaccordion_body',wrapClass:'liknoaccordion_wrap',navigationClass:'liknoaccordion_navButton'},indicator:{show:false,hasText:false,hasImage:true,normalImage:'',normalOverImage:'',selectedImage:'',selectedOverImage:'',imageWidth:10,imageHeight:10,normalText:'',normalOverText:'',selectedText:'',selectedOverText:'',commonCss:{'cursor':'pointer',display:'inline-block',position:'absolute','list-style-type':'none','list-style-position':'outside',borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},normalCss:{},normalOverCss:{},selectedCss:{},selectedOverCss:{},trigger:"click"},header:{backgroundImages:{show:false,openLeft:"",openTile:"",openRight:"",closedLeft:"",closedTile:"",closedRight:"",openOverLeft:"",openOverTile:"",openOverRight:"",closedOverLeft:"",closedOverTile:"",closedOverRight:"",separatorLeft:"",separatorTile:"",separatorRight:"",closedLeftWidth:0,closedRightWidth:0,openLeftWidth:0,openRightWidth:0,closedOverLeftWidth:0,closedOverRightWidth:0,openOverLeftWidth:0,openOverRightWidth:0,separatorLeftWidth:0,separatorRightWidth:0},images:{accordionNormal:'',accordionMouse:'',accordionSelectedNormal:'',accordionSelectedMouse:''},hasImage:false,styleHeaders:true,text:'',commonCss:{display:'block',position:'relative','list-style-type':'none','list-style-position':'outside',borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},normalCss:{},normalOverCss:{},selectedCss:{},selectedOverCss:{},separatorCss:{display:"inline-block",'overflow':'hidden','list-style-type':'none','list-style-position':'outside',borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},trigger:"click"},wrapCss:{borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},bodyCss:{borderWidth:0,'list-style-type':'none','list-style-position':'outside'},containerCss:{borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},paneCss:{borderWidth:0,"box-sizing":"content-box","-moz-box-sizing":"content-box","-webkit-box-sizing":"content-box","-ms-box-sizing":"content-box"},play:{autoStart:false,pauseByMouse:true,direction:0,delay:1000,timer:null,isPaused:false,isRunning:false,loop:true},currentSheet:0,navigationBar:{maxSheets:9,show:false,showFirst:true,showPrev:true,showPlayPause:false,showText:true,showSheets:true,showNext:true,showLast:true,isFloating:false,fullSize:true,playerCss:{},text:'Sheets: ',images:{butFirst:'',butFirstOver:'',butPrev:'',butPrevOver:'',butPlay:'',butPlayOver:'',butPause:'',butPauseOver:'',butNext:'',butNextOver:'',butLast:'',butLastOver:''}},ajaxLoadDiv:'loading...',ajaxLoadImage:'',transition:{transWhat:{},transHow:"linear",transDuration:0},scrollDefined:false};function LiknoAccordion(data,options){var self=this,opts=null,ieQuirks=!$.support.boxModel,ie6=$.browser.msie&&($.browser.version=="6.0"),ieCM=$.browser.msie&&((document.documentMode?document.documentMode:(document.compatMode&&document.compatMode=="CSS1Compat")?7:5)<8),dialog={};if(typeof(options)=="undefined")options={};$.extend(self,{autoPlayStart:function(){if(dialog.accordionBodies.length>1&&!opts.play.timer){opts.play.isRunning=true;var intrvl=self.getDelay(opts.transition.transDuration)+opts.play.delay;opts.play.timer=setInterval(function(){self.autoPlayDoPlay()},intrvl);if(opts.navigationBar.show&&typeof(dialog.navigationBar.play.showNormal)=="function"){dialog.navigationBar.play.showNormal()}}},autoPlayStop:function(){opts.play.isRunning=false;if(opts.play.timer){clearInterval(opts.play.timer);opts.play.timer=null;if(opts.navigationBar.show&&typeof(dialog.navigationBar.play.showNormal)=="function"){dialog.navigationBar.play.showNormal()}}},autoPlayToggle:function(){if(opts.play.isRunning)self.autoPlayStop();else self.autoPlayStart()},autoPlayDoPlay:function(){if(!opts.play.isPaused){if(opts.play.direction==0)self.gotoNext(true);else if(opts.play.direction==1)self.gotoPrev(true);else if(opts.play.direction==2){if(dialog.accordionBodies.length>1){var tmp=dialog.currentSheet;while(tmp==dialog.currentSheet)tmp=Math.ceil(dialog.accordionBodies.length*Math.random()-1);self.gotoSheet(tmp,true)}}}},gotoFirst:function(){if(dialog.currentSheet!=0)self.gotoSheet(0)},gotoPrev:function(isAuto){if(typeof isAuto=="undefined")isAuto=false;if(isAuto&&dialog.currentSheet==0&&!opts.play.loop)self.autoPlayStop();self.gotoSheet((dialog.currentSheet==0)?(opts.play.loop?dialog.accordionBodies.length-1:0):(dialog.currentSheet-1),isAuto)},gotoNext:function(isAuto){if(typeof isAuto=="undefined")isAuto=false;if(isAuto&&dialog.currentSheet==dialog.accordionBodies.length-1&&!opts.play.loop)self.autoPlayStop();self.gotoSheet((dialog.currentSheet==dialog.accordionBodies.length-1)?(opts.play.loop?0:dialog.accordionBodies.length-1):(dialog.currentSheet+1),isAuto)},gotoLast:function(){if(dialog.currentSheet!=dialog.accordionBodies.length-1)self.gotoSheet(dialog.accordionBodies.length-1)},gotoSheet:function(p,isAuto,allowTransition){if(dialog.working)return;dialog.working=true;if(typeof isAuto=="undefined")isAuto=false;if(typeof allowTransition=="undefined")allowTransition=true;if(p!=dialog.currentSheet){if(p<0)p=0;if(p>=dialog.accordionBodies.length)p=dialog.accordionBodies.length-1;dialog.currentSheet=p;self.setData(allowTransition,isAuto)}else if(!opts.dependentPanes||opts.allowAllClosed){if(p<0)p=0;if(p>=dialog.accordionBodies.length)p=dialog.accordionBodies.length-1;dialog.currentSheet=p;self.setData(allowTransition,isAuto)}else{dialog.working=false}},bindNavigationImages:function(){var all=$("img[src*='likno_accordion']").filter("[src$='gif'],[src*='png'],[src*='jpg']");if(all.filter("[src*='likno_accordion_"+opts.accordionName+"']").length>0){all=all.filter("[src*='likno_accordion_"+opts.accordionName+"']")}else if(all.filter("[src*='likno_accordion_"+opts.accordionNameNormal+"']").length>0){all=all.filter("[src*='likno_accordion_"+opts.accordionNameNormal+"']")}else{all=all.filter("[src*='likno_accordion_generic']")}if(all.length>0){var nb=dialog.navigationBar={};var onbi=opts.navigationBar.images;$.each([["previous","previous","Prev"],["next","next","Next"],["first","first","First"],["last","last","Last"],["play","play","Play"],["play","pause","Pause"]],function(i,el){var b=all.filter("[src$='_"+el[0]+".gif'],[src$='_"+el[0]+".png'],[src$='_"+el[0]+".jpg']");if(b.length>0){var base=b.attr("src");var bi=base.replace("_"+el[0]+".","_"+el[1]+".");var bio=base.replace("_"+el[0]+".","_"+el[1]+"_over.");if(el[0]!="play")b.mouseover(function(){$(this).attr("src",bio)}).mouseout(function(){$(this).attr("src",bi)}).click(function(e){eval("self.goto"+el[2]+"();")});b.addClass(opts.classes.navigationClass);b.css('cursor','pointer');lwac_imageCache[lwac_imageCacheCounter]=new Image(1,1);lwac_imageCache[lwac_imageCacheCounter++].src=bi;lwac_imageCache[lwac_imageCacheCounter]=new Image(1,1);lwac_imageCache[lwac_imageCacheCounter++].src=bio;eval("onbi.but"+el[2]+" = bi;");eval("onbi.but"+el[2]+"Over = bio;")}eval("nb."+el[1]+" = b;")});if(nb.play.length>0){nb.play.showOver=function(){if(opts.play.isRunning)$(this).attr("src",onbi.butPlayOver);else $(this).attr("src",onbi.butPauseOver)};nb.play.showNormal=function(){if(opts.play.isRunning)$(this).attr("src",onbi.butPlay);else $(this).attr("src",onbi.butPause)};nb.play.mouseover(function(){nb.play.showOver()}).mouseout(function(){nb.play.showNormal()}).click(function(e){self.autoPlayToggle()});nb.play.showNormal()}}},setData:function(allowTransition,isAuto){if(dialog.currentSheet==-1)return;var data=dialog.accordionBodies[dialog.currentSheet];if(!dialog.accordionBodies[dialog.currentSheet].data("isLoaded")){var tmp=dialog.oldSheet;self.openCloseAccordion(dialog.currentSheet,null,false);dialog.wrap[dialog.currentSheet].show();dialog.accordionBodies[dialog.currentSheet].data("isLoaded",true);if(dialog.accordionBodies[dialog.currentSheet].data("isImage")){var t=dialog.wrap[dialog.currentSheet].innerHeight()-(self.getVal(dialog.accordionBodies[dialog.currentSheet].css('padding-top'))+self.getVal(dialog.accordionBodies[dialog.currentSheet].css('padding-bottom')));var l=dialog.wrap[dialog.currentSheet].innerWidth()-(self.getVal(dialog.accordionBodies[dialog.currentSheet].css('padding-left'))+self.getVal(dialog.accordionBodies[dialog.currentSheet].css('padding-right')));t=(t-dialog.accordionBodies[dialog.currentSheet].children("img").height())/2;l=(l-dialog.accordionBodies[dialog.currentSheet].children("img").width())/2;t=t>0?Math.floor(t):0;l=l>0?Math.floor(l):0;dialog.accordionBodies[dialog.currentSheet].children("img").css({"margin-top":t,"margin-left":l})}else if(data[0].tagName=="DIV"||data[0].tagName=="LI"){if(data.attr("ajaxUrl")&&data.attr("ajaxUrl")!=""){var url=data.attr("ajaxUrl");dialog.accordionBodies[dialog.currentSheet].html($("<table border='0' cellpadding='0' cellspacing='0' width='100%' height='100%'/>").html($("<tr/>").html($("<td align='center' valign='middle'/>").html(opts.ajaxLoadDiv))));dialog.accordionBodies[dialog.currentSheet].load(dialog.accordionBodies[dialog.currentSheet].attr('ajaxUrl'),function(){$(this).css(opts.bodyCss);$(this).data('isAjax',true);if(dialog.accordionBodies[dialog.currentSheet].height()>dialog.wrap[dialog.currentSheet].height()){dialog.accordionBodies[dialog.currentSheet].css({'width':self.getVal(dialog.accordionBodies[dialog.currentSheet].css('width'))-self.getScrollbarWidth()})}})}else if(data.attr("externalUrl")&&data.attr("externalUrl")!=""){var url=data.attr("externalUrl");dialog.dataFrame=$("<iframe src='' width='100%' height='100%' frameborder='0' style='"+((typeof opts.wrapCss.backgroundColor!="undefined")?" background-color: "+opts.wrapCss.backgroundColor+";":"")+((typeof opts.wrapCss.overflow!="undefined")?" overflow: "+opts.wrapCss.overflow+";":"")+"'></iframe>");dialog.accordionBodies[dialog.currentSheet].html($("<table border='0' cellpadding='0' cellspacing='0' padding='0' margin='0' width='100%' height='100%'/>").html($("<tr/>").html($("<td align='center' valign='middle' style='padding: 0px;'/>").html(dialog.dataFrame))));dialog.accordionBodies[dialog.currentSheet].data('isExternal',true);dialog.accordionBodies[dialog.currentSheet].css({'position':'absolute','padding':'0px','top':'0','left':'0'});var s=self.getInnerSize(dialog.wrap[dialog.currentSheet]);if(s.h>0&&s.w>0){dialog.dataFrame.css({'height':s.h,'width':s.w})}dialog.accordionBodies[dialog.currentSheet].css({'overflow':'hidden','width':s.w,'height':s.h});dialog.wrap[dialog.currentSheet].css({'overflow':'hidden'});setTimeout(function(){dialog.dataFrame.load(function(){try{dialog.dataFrame.contents().find("body").css(opts.bodyCss)}catch(e){}});dialog.dataFrame.attr('src',url)},50)}}self.openCloseAccordion(null,dialog.currentSheet,false);dialog.oldSheet=tmp}if(!dialog.wrap[dialog.currentSheet].data("isOpen")){if(opts.dependentPanes){if(dialog.oldSheet!=null){this.openCloseAccordion(dialog.currentSheet,dialog.oldSheet,allowTransition)}else{this.openCloseAccordion(dialog.currentSheet,null,allowTransition)}}else{this.openCloseAccordion(dialog.currentSheet,null,allowTransition)}dialog.oldSheet=dialog.currentSheet}else{this.openCloseAccordion(null,dialog.currentSheet,allowTransition);dialog.oldSheet=null}if(opts.header.styleHeaders){for(var i=0;i<dialog.accordionHeaders.length;i++){if(dialog.wrap[dialog.accordionHeaders[i].data('targetSheet')].data('isOpen'))self.setHeaderStyle(dialog.accordionHeaders[i],false,dialog.wrap[dialog.accordionHeaders[i].data('targetSheet')].data('isOpen'));if(opts.indicator.show)if(dialog.wrap[dialog.accordionHeaders[i].indicator.data('targetSheet')].data('isOpen'))self.setHeaderIndicatorStyle(dialog.accordionHeaders[i],false,dialog.wrap[dialog.accordionHeaders[i].data('targetSheet')].data('isOpen'))}}},closeAllAccordions:function(allowTransition){for(var i=0;i<dialog.accordionBodies.length;i++){this.openCloseAccordion(null,i,allowTransition)}},openAllAccordions:function(allowTransition){for(var i=0;i<dialog.accordionBodies.length;i++)this.openCloseAccordion(i,null,allowTransition)},openCloseAccordion:function(newAcc,oldAcc,allowTransition){if(typeof allowTransition=="undefined")allowTransition=false;if(typeof opts.transition.transWhat.opacity!="undefined")dialog.openCloseDiv.css('opacity','0.5');if(newAcc!=null){dialog.wrap[newAcc].show();if(dialog.wrap[newAcc].data('overflow')==null)dialog.wrap[newAcc].data('overflow',dialog.wrap[newAcc].css('overflow'));dialog.wrap[newAcc].css('overflow','hidden')}if(oldAcc!=null){dialog.wrap[oldAcc].data('overflow',dialog.wrap[oldAcc].css('overflow'));dialog.wrap[oldAcc].css('overflow','hidden')}if(!lQuery.support.opacity&&typeof opts.transition.transWhat.opacity=="string"){if(newAcc!=null){dialog.wrap[newAcc].hide();dialog.wrap[newAcc].fadeIn(allowTransition?opts.transition.transDuration:0,function(){$(this).data("isOpen",true);self.setHeaderStyle(dialog.accordionHeaders[newAcc],false,true);if(opts.indicator.show)self.setHeaderIndicatorStyle(dialog.accordionHeaders[newAcc],false,true)});dialog.wrap[newAcc].css('overflow',dialog.wrap[newAcc].data('overflow'))}if(oldAcc!=null){dialog.wrap[oldAcc].fadeOut(allowTransition?opts.transition.transDuration:0,function(){$(this).data("isOpen",false);self.setHeaderStyle(dialog.accordionHeaders[oldAcc],false,false);if(opts.indicator.show)self.setHeaderIndicatorStyle(dialog.accordionHeaders[oldAcc],false,false)});dialog.wrap[oldAcc].css('overflow',dialog.wrap[oldAcc].data('overflow'))}dialog.oldSheet=newAcc;if(opts.positioning.type>=10)self.setContainerPositioning();if($.browser.msie&&opts.singleContainer){var tmp=dialog.container.parent().css('display');dialog.container.parent().css('display','none').css('display',tmp);setTimeout(function(){dialog.container.parent().css('display','none').css('display',tmp)},(allowTransition?opts.transition.transDuration:0)+10)}dialog.working=false}else{dialog.openCloseDiv.animate(opts.transition.transWhat,{duration:allowTransition?opts.transition.transDuration:0,easing:opts.transition.transHow,step:function(now,settings){var percentDone=settings.start!=settings.end?(settings.now-settings.start)/(settings.end-settings.start):0,currentO=0,currentC=0;if(oldAcc!=null)currentC=(1-percentDone)*dialog.wrap[oldAcc].data(settings.prop);if(newAcc!=null)currentO=percentDone*dialog.wrap[newAcc].data(settings.prop);currentC=Math.floor(currentC);currentO=Math.ceil(currentO);if(isNaN(currentO)||isNaN(currentC))return;if(settings.prop=='opacity'){if(oldAcc!=null)dialog.wrap[oldAcc][0].style[settings.prop]=currentC;if(newAcc!=null)dialog.wrap[newAcc][0].style[settings.prop]=currentO}else{if(oldAcc!=null){dialog.wrap[oldAcc][0].style[settings.prop]=currentC+'px';if(settings.prop=="width"||settings.prop=="height")dialog.wrap[oldAcc][0].style['display']=currentC==0?'none':'block'}if(newAcc!=null){dialog.wrap[newAcc][0].style[settings.prop]=currentO+'px';if(settings.prop=="width"||settings.prop=="height")dialog.wrap[newAcc][0].style['display']=currentO==0?'none':'block'}}if(opts.positioning.type>=10)self.setContainerPositioning();if($.browser.msie&&$.browser.version.charAt(0)<"9"&&opts.singleContainer){dialog.openCloseDivHelper.html(".")}},complete:function(){if(oldAcc!=null){dialog.wrap[oldAcc].data("isOpen",false);dialog.wrap[oldAcc].css('overflow',dialog.wrap[oldAcc].data('overflow'));self.setHeaderStyle(dialog.accordionHeaders[oldAcc],false,false);if(opts.indicator.show)self.setHeaderIndicatorStyle(dialog.accordionHeaders[oldAcc],false,false);dialog.wrap[oldAcc].hide()}dialog.oldSheet=newAcc;if(newAcc!=null){dialog.wrap[newAcc].data("isOpen",true);dialog.wrap[newAcc].css('overflow',dialog.wrap[newAcc].data('overflow'));setTimeout(function(){self.setHeaderStyle(dialog.accordionHeaders[newAcc],false,true);if(opts.indicator.show)self.setHeaderIndicatorStyle(dialog.accordionHeaders[newAcc],false,true)},0)}dialog.working=false;if(opts.positioning.type>=10)self.setContainerPositioning()}})}},createAndStart:function(){if(opts.loadingHeaderImages&&!$.browser.msie){setTimeout(self.createAndStart,1)}else{self.create();data=null;if(opts.play.autoStart)self.autoPlayStart();self.dialog=dialog;if(opts.getFocus){$('html,body').animate({scrollTop:dialog.accordionHeadersSeparators[dialog.currentSheet].offset().top})}}},create:function(){dialog.openCloseDiv=$("<div>&nbsp;</div>").css("line-height","0px").css({width:"1000px",height:"1000px",border:"#000 solid 10px",margin:"10px",padding:"10px",opacity:"1"});dialog.openCloseDivHelper=$("<div>&nbsp;</div>").css({"position":"absolute","left":"-50px","top":"-50px","width":"10px","height":"10px","border":"none","margin":"0px","padding":"0px","opacity":"1"}).appendTo($("body"));dialog.wrap=new Array();for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i]=$("<div></div>").addClass(opts.classes.wrapClass).css(opts.wrapCss).css({display:'block',overflow:'auto'}).css({position:'relative'});dialog.wrap[i].insertBefore(dialog.accordionBodies[i]);dialog.wrap[i].append(dialog.accordionBodies[i]);dialog.wrap[i].data('no',i);dialog.wrap[i].data("isOpen",true)}dialog.paneContainer=new Array();for(var i=0;i<dialog.wrap.length;i++){dialog.paneContainer[i]=$("<div></div>").addClass(opts.classes.paneContainerClass).css($.extend(true,opts.paneCss,{zIndex:opts.zIndex+2}));dialog.paneContainer[i].insertBefore(dialog.accordionHeaders[i]);if(opts.direction=="top"||opts.direction=="left"){dialog.paneContainer[i].append(dialog.accordionHeaders[i]);dialog.paneContainer[i].append(dialog.wrap[i])}else{dialog.paneContainer[i].append(dialog.wrap[i]);dialog.paneContainer[i].append(dialog.accordionHeaders[i])}}if(opts.singleContainer){dialog.container=$("<div></div>").addClass(opts.classes.containerClass).css($.extend(true,opts.containerCss,{clear:'both',zIndex:opts.zIndex+2}));if(dialog.accordionHeadersSeparators[0].data("isSeparator"))dialog.container.insertBefore(dialog.accordionHeadersSeparators[0]);else dialog.container.insertBefore(dialog.paneContainer[0]);for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){if(dialog.accordionHeadersSeparators[i].data("isSeparator"))dialog.container.append(dialog.accordionHeadersSeparators[i]);else dialog.container.append(dialog.paneContainer[dialog.accordionHeadersSeparators[i].data("targetSheet")])}}if(opts.positioning.type>0){if($(opts.positioning.selector).length>0){switch(opts.positioning.type){case 1:if(opts.singleContainer){dialog.container.appendTo($(opts.positioning.selector))}else{for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){if(dialog.accordionHeadersSeparators[i].data("isSeparator")){dialog.accordionHeadersSeparators[i].appendTo($(opts.positioning.selector))}else{dialog.paneContainer[dialog.accordionHeadersSeparators[i].data('headerno')].appendTo($(opts.positioning.selector))}}}break;case 2:if(opts.singleContainer){dialog.container.insertBefore($(opts.positioning.selector))}else{for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){if(dialog.accordionHeadersSeparators[i].data("isSeparator")){dialog.accordionHeadersSeparators[i].insertBefore($(opts.positioning.selector))}else{dialog.paneContainer[dialog.accordionHeadersSeparators[i].data('headerno')].insertBefore($(opts.positioning.selector))}}}$(opts.positioning.selector).remove();break;case 10:case 11:case 12:dialog.container.appendTo($("body"));break}}else{if(opts.singleContainer){dialog.container.remove()}else{for(var i=0;i<dialog.paneContainer.length;i++)dialog.paneContainer[i].remove()}alert('Likno Web Accordion Builder Error: Positioning element "'+opts.positioning.selector+'" is not found in page.')}}else{$("<div>&nbsp;</div>").css("line-height","0px").insertBefore(dialog.container).append(dialog.container)}if(opts.navigationBar.show)self.bindNavigationImages();dialog.currentSheet=opts.currentSheet;self.setContainerDimensions();if(dialog.currentSheet<-2)dialog.currentSheet=0;if(dialog.currentSheet>=dialog.accordionBodies.length)dialog.currentSheet=dialog.accordionBodies.length-1;if(dialog.accordionBodies.length>0){dialog.working=false;self.open();self.closeAllAccordions(false);dialog.oldSheet=null;if(dialog.currentSheet==-2)self.openAllAccordions(false);else if(dialog.currentSheet>=0){self.setData(false,true)}}if(opts.positioning.type>=10)$(window).bind('resize',function(){self.setContainerPositioning()});if(opts.positioning.type>=10)self.setContainerPositioning();if(opts.play.pauseByMouse){$("."+opts.classes.separatorClass+", ."+opts.classes.headerClass+", ."+opts.classes.bodyClass+", ."+opts.classes.paneContainerClass+", ."+opts.classes.containerClass).bind("mouseover.autoplay",function(){opts.play.isPaused=true}).bind("mouseout.autoplay",function(){opts.play.isPaused=false})}},setContainerPositioning:function(){dialog.container.css({'top':'0','left':'0'});opts.posCss={};var el={};if(opts.positioning.type==10){var w=self.getDimensions();el.left=0;el.top=0;el.width=w[1];el.height=w[0];opts.positioning.accordionCorner=opts.positioning.elementCorner}else if(opts.positioning.type==11||opts.positioning.type==12){var pos=$(opts.positioning.selector).offset();el.left=pos.left;el.top=pos.top;el.width=$(opts.positioning.selector).width();el.height=$(opts.positioning.selector).height()}if(opts.positioning.elementCorner==0||opts.positioning.elementCorner==1||opts.positioning.elementCorner==2){opts.posCss.top=el.top}if(opts.positioning.elementCorner==3||opts.positioning.elementCorner==7||opts.positioning.elementCorner==8){opts.posCss.top=el.top+el.height/2}if(opts.positioning.elementCorner==4||opts.positioning.elementCorner==5||opts.positioning.elementCorner==6){opts.posCss.top=el.top+el.height}if(opts.positioning.elementCorner==0||opts.positioning.elementCorner==6||opts.positioning.elementCorner==7){opts.posCss.left=el.left}if(opts.positioning.elementCorner==1||opts.positioning.elementCorner==5||opts.positioning.elementCorner==8){opts.posCss.left=el.left+el.width/2}if(opts.positioning.elementCorner==2||opts.positioning.elementCorner==3||opts.positioning.elementCorner==4){opts.posCss.left=el.left+el.width}if(opts.positioning.accordionCorner==3||opts.positioning.accordionCorner==7||opts.positioning.accordionCorner==8){opts.posCss.top-=dialog.container.outerHeight()/2}if(opts.positioning.accordionCorner==4||opts.positioning.accordionCorner==5||opts.positioning.accordionCorner==6){opts.posCss.top-=dialog.container.outerHeight()}if(opts.positioning.accordionCorner==1||opts.positioning.accordionCorner==5||opts.positioning.accordionCorner==8){opts.posCss.left-=dialog.container.outerWidth()/2}if(opts.positioning.accordionCorner==2||opts.positioning.accordionCorner==3||opts.positioning.accordionCorner==4){opts.posCss.left-=dialog.container.outerWidth()}opts.posCss.left+=opts.positioning.posX;opts.posCss.top+=opts.positioning.posY;opts.posCss.position="absolute";dialog.container.css(opts.posCss);if(opts.positioning.drifty){if(ie6||ieQuirks){dialog.container.css({'top':opts.posCss.top+$(window).scrollTop(),'left':opts.posCss.left+$(window).scrollLeft()});if(!opts.scrollDefined){$(window).scroll(function(){dialog.container.css({'top':opts.posCss.top+$(window).scrollTop(),'left':opts.posCss.left+$(window).scrollLeft()})});opts.scrollDefined=true}}else{dialog.container.css("position","fixed")}}},open:function(){if($.isFunction(opts.onOpen)){opts.onOpen.apply(self,[dialog])}else{}},myTrim:function(str){str=str.replace(/^\s+/,'');for(var i=str.length-1;i>=0;i--){if(/\S/.test(str.charAt(i))){str=str.substring(0,i+1);break}}return str},getVal:function(v){if(typeof v=="number")return v;if(v){switch(v){case'auto':return 0;case'medium':return 1;default:return parseInt(v.replace(/px/,''))}}else return 0},focus:function(pos){var p=pos||'first';var input=$(":input:enabled:visible:"+p,dialog.container);input.length>0?input.focus():dialog.container.focus()},getDimensions:function(){var el=$(window);var h=$.browser.opera&&$.browser.version>'9.5'&&$.fn.jquery<='1.2.6'?document.documentElement['clientHeight']:$.browser.opera&&$.browser.version<'9.5'&&$.fn.jquery>'1.2.6'?window.innerHeight:el.height();var w=el.width();return[h,w]},getScrollbarWidth:function scrollbarWidth(){var inner=document.createElement('p');inner.style.width="100%";inner.style.height="200px";var outer=document.createElement('div');outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow='scroll';var w2=inner.offsetWidth;if(w1==w2)w2=outer.clientWidth;document.body.removeChild(outer);return(w1-w2)},getInnerSize:function(x){var tmpH=this.getVal(x.css('borderTopWidth'))+this.getVal(x.css('borderBottomWidth'))+this.getVal(x.css('paddingBottom'))+this.getVal(x.css('paddingTop'));var tmpW=this.getVal(x.css('borderLeftWidth'))+this.getVal(x.css('borderRightWidth'))+this.getVal(x.css('paddingLeft'))+this.getVal(x.css('paddingRight'));var size={};size.w=this.getVal(x.css('width'));size.h=this.getVal(x.css('height'));if(size.h==0)size.h=x.height();if(size.w==0)size.w=x.width();if(ieQuirks){}if(size.w<0)size.w=0;if(size.h<0)size.h=0;return size},setContainerDimensions:function(){if(opts.direction=="top"||opts.direction=="bottom"){self.setVerticalDimensions()}else{self.setHorizontalDimensions()}for(var i=0;i<dialog.wrap.length;i++){dialog.wrap[i].data('borderTopWidth',self.getVal(dialog.wrap[i].css('borderTopWidth')));dialog.wrap[i].data('borderRightWidth',self.getVal(dialog.wrap[i].css('borderRightWidth')));dialog.wrap[i].data('borderBottomWidth',self.getVal(dialog.wrap[i].css('borderBottomWidth')));dialog.wrap[i].data('borderLeftWidth',self.getVal(dialog.wrap[i].css('borderLeftWidth')));dialog.wrap[i].data('marginTop',self.getVal(dialog.wrap[i].css('marginTop')));dialog.wrap[i].data('marginRight',self.getVal(dialog.wrap[i].css('marginRight')));dialog.wrap[i].data('marginBottom',self.getVal(dialog.wrap[i].css('marginBottom')));dialog.wrap[i].data('marginLeft',self.getVal(dialog.wrap[i].css('marginLeft')));dialog.wrap[i].data('paddingTop',self.getVal(dialog.wrap[i].css('paddingTop')));dialog.wrap[i].data('paddingRight',self.getVal(dialog.wrap[i].css('paddingRight')));dialog.wrap[i].data('paddingBottom',self.getVal(dialog.wrap[i].css('paddingBottom')));dialog.wrap[i].data('paddingLeft',self.getVal(dialog.wrap[i].css('paddingLeft')));dialog.wrap[i].data('width',self.getInnerSize(dialog.wrap[i]).w);dialog.wrap[i].data('height',self.getInnerSize(dialog.wrap[i]).h);dialog.wrap[i].data('opacity',self.getVal(dialog.wrap[i].css('opacity')))}},setHorizontalDimensions:function(){var ch=0,cw=0,wh=0,ww=0,bh=0,bw=0,hh=0,hw=0,ph=0,pw=0;var _ch=0,_cw=0,_wh=0,_ww_b=0,_ww_m=0,_bh=0,_bw=0,_hw_b=0,_hw_m=0,_hw_p=0,_sh=0,_sw=0;var totalHeaderSize=0,IE8ItalicFix=0,maxHeight=0,IE6MarginFix=0;if(opts.singleContainer){for(var i=0;i<dialog.wrap.length;i++)dialog.wrap[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.accordionHeaders.length;i++)dialog.accordionHeaders[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.accordionSeparators.length;i++)dialog.accordionSeparators[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.paneContainer.length;i++)dialog.paneContainer[i].css({'display':'none','float':'none'});var tmp=$("<span style='font-size: 1px;'>&nbsp;</span>");dialog.container.append(tmp);cw=self.getInnerSize(dialog.container).w;tmp.remove();_cw=this.getVal(dialog.container.css('borderLeftWidth'))+this.getVal(dialog.container.css('borderRightWidth'))+this.getVal(dialog.container.css('paddingLeft'))+this.getVal(dialog.container.css('paddingRight'));if(ieQuirks){cw+=_cw}for(var i=0;i<dialog.paneContainer.length;i++)dialog.paneContainer[i].css({'display':'inline-block','float':'none'});for(var i=0;i<dialog.wrap.length;i++)dialog.wrap[i].css({'display':'inline-block','float':'none'});for(var i=0;i<dialog.accordionHeaders.length;i++)dialog.accordionHeaders[i].css({'display':'inline-block','float':'none'});for(var i=0;i<dialog.accordionSeparators.length;i++)dialog.accordionSeparators[i].css({'display':'inline-block','float':'none'})}var tmpW=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.wrapCss),tmpB=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.bodyCss),tmpH=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.header.normalCss),tmpP=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);IE8ItalicFix=((tmpW.css('font-style')=="italic"||tmpW.css('font-style')=="oblique")&&$.browser.msie&&parseInt($.browser.version.substring(0,1))>5)?parseInt(this.getVal(tmpW.css('font-size'))/3):0;_wh_b=this.getVal(tmpW.css('borderTopWidth'))+this.getVal(tmpW.css('borderBottomWidth'));_wh_m=this.getVal(tmpW.css('marginTop'))+this.getVal(tmpW.css('marginBottom'));_ww_b=this.getVal(tmpW.css('borderLeftWidth'))+this.getVal(tmpW.css('borderRightWidth'));_ww_m=this.getVal(tmpW.css('marginLeft'))+this.getVal(tmpW.css('marginRight'));_bh=this.getVal(tmpB.css('paddingTop'))+this.getVal(tmpB.css('paddingBottom'));_bw=this.getVal(tmpB.css('paddingLeft'))+this.getVal(tmpB.css('paddingRight'));_hw_b=this.getVal(tmpH.css('borderLeftWidth'))+this.getVal(tmpH.css('borderRightWidth'));_hw_m=this.getVal(tmpH.css('marginLeft'))+this.getVal(tmpH.css('marginRight'));_hw_p=this.getVal(tmpH.css('paddingLeft'))+this.getVal(tmpH.css('paddingRight'));_pw_b=this.getVal(tmpP.css('borderLeftWidth'))+this.getVal(tmpP.css('borderRightWidth'));_pw_m=this.getVal(tmpP.css('marginLeft'))+this.getVal(tmpP.css('marginRight'));_pw_p=this.getVal(tmpP.css('paddingLeft'))+this.getVal(tmpP.css('paddingRight'));tmpW.remove();tmpB.remove();tmpH.remove();tmpP.remove();if(typeof opts.paneCss.width!="undefined"){for(var i=0;i<dialog.accordionBodies.length;i++){dialog.accordionHeaders[i].css('display','inline'+(ieQuirks?'':'-block'));self.setHeaderStyle(dialog.accordionHeaders[i],false,false);hw=dialog.accordionHeaders[i].innerWidth();ww=this.getVal(opts.paneCss.width)-(hw+_hw_b+_hw_m+_ww_b+_ww_m);if(ieQuirks){ww=ww+(_ww_b);bw=ww-(_ww_b+_ww_m)}else{bw=ww-_bw}dialog.wrap[i].css({width:ww});dialog.accordionBodies[i].css('width',bw-IE8ItalicFix);dialog.paneContainer[i].css('width','')}}else{for(var i=0;i<dialog.accordionHeaders.length;i++){self.setHeaderStyle(dialog.accordionHeaders[i],false,false);dialog.accordionHeaders[i].css({'display':'inline','float':'none','clear':'both'});dialog.accordionBodies[i].css({'display':'none'});self.setFixedHeaderWidth(dialog.accordionHeaders[i]);hw=dialog.accordionHeaders[i].innerWidth();totalHeaderSize+=hw+_hw_p+_hw_m+_hw_b+_pw_b+_pw_m+_pw_p;if(!ieQuirks)totalHeaderSize-=_hw_p;dialog.accordionHeaders[i].css({'display':((ie6||ieQuirks)?'inline':'inline-block'),'float':'left','clear':''});dialog.accordionBodies[i].css({'display':'block'})}for(var i=0;i<dialog.accordionSeparators.length;i++){dialog.accordionSeparators[i].css({'display':'inline','float':'none','clear':'both'});hw=this.getInnerSize(dialog.accordionSeparators[i]).w;_hw=this.getVal(dialog.accordionSeparators[i].css('borderLeftWidth'))+this.getVal(dialog.accordionSeparators[i].css('borderRightWidth'))+this.getVal(dialog.accordionSeparators[i].css('paddingLeft'))+this.getVal(dialog.accordionSeparators[i].css('paddingRight'))+this.getVal(dialog.accordionSeparators[i].css('marginLeft'))+this.getVal(dialog.accordionSeparators[i].css('marginRight'));totalHeaderSize+=hw+_hw;dialog.accordionSeparators[i].css({'display':((ie6||ieQuirks)?'inline':'inline-block'),'float':'left','clear':''})}if(opts.singleContainer){if(typeof opts.containerCss.width!="undefined"||typeof opts.bodyCss.width=="undefined"){ww=cw-totalHeaderSize;if(ieQuirks){ww=ww-(_cw+_ww_m);bw=ww-(_ww_b+_ww_m)}else{ww=ww-(_ww_b+_ww_m);bw=ww-_bw}}else{bw=this.getVal(opts.bodyCss.width)+_bw;if(ieQuirks){bw=bw;ww=bw+(_ww_b+_ww_m);cw=ww+totalHeaderSize+(_ww_b+_ww_m)}else{bw=bw-_bw;ww=bw+_bw;cw=ww+totalHeaderSize+(_ww_b+_ww_m)}}for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i].css({width:ww});dialog.accordionBodies[i].css({'width':bw-IE8ItalicFix})}}else{var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css({'display':'block','float':'none','clear':'both'});tmp.insertBefore(dialog.accordionHeadersSeparators[0].data("isSeparator")?dialog.accordionHeadersSeparators[0]:dialog.paneContainer[0]);var maxAvailableWidth=tmp.innerWidth();tmp.remove();if(typeof opts.bodyCss.width=="undefined"){bw=maxAvailableWidth-(totalHeaderSize+_ww_b+_ww_m);if(ieQuirks)bw-=self.getScrollbarWidth()}else{bw=this.getVal(opts.bodyCss.width);if(ieQuirks)bw+=_bw}ww=bw;bw=bw-_bw;for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i].css({width:ww});dialog.accordionBodies[i].css({'width':bw-IE8ItalicFix})}}}if(opts.singleContainer)dialog.container.css({'width':((ieCM||ie6)?cw+self.getVal(dialog.container.css("paddingLeft")):''),'display':'inline-block'});$.each([opts.header.normalCss,opts.header.normalOverCss,opts.header.selectedCss,opts.header.selectedOverCss],function(i,el){if(typeof el.width!="undefined"){var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(el);if(ieQuirks){el.width=self.getVal(el.width)+self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'))+self.getVal(tmp.css('borderLeftWidth'))+self.getVal(tmp.css('borderRightWidth'))}else{}tmp.remove()}});if(ieQuirks){for(var i=0;i<dialog.accordionHeaders.length;i++){if(typeof dialog.accordionHeaders[i].data('customOptions')!="undefined"){$.each([dialog.accordionHeaders[i].data('customOptions').normalCss,dialog.accordionHeaders[i].data('customOptions').normalOverCss,dialog.accordionHeaders[i].data('customOptions').selectedCss,dialog.accordionHeaders[i].data('customOptions').selectedOverCss],function(i,el){if(typeof el!="undefined"&&typeof el.width!="undefined"){var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(el);el.width=self.getVal(el.width)+self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'))+self.getVal(tmp.css('borderLeftWidth'))+self.getVal(tmp.css('borderRightWidth'));if(opts.header.backgroundImages.show)el.width+=self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'));tmp.remove()}})}}}var tmp_p=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);_ph=this.getVal(tmp_p.css("paddingTop"))+this.getVal(tmp_p.css("paddingBottom"))+this.getVal(tmp_p.css("marginTop"))+this.getVal(tmp_p.css("marginBottom"))+this.getVal(tmp_p.css("borderTopWidth"))+this.getVal(tmp_p.css("borderBottomWidth"));tmp_p.remove();if(typeof opts.paneCss.height!="undefined"){ch=this.getVal(opts.paneCss.height)+_ph}else if(typeof opts.containerCss.height!="undefined"&&opts.singleContainer){ch=this.getVal(opts.containerCss.height)}else{var tmp_el,elh;for(var i=0;i<dialog.accordionHeaders.length;i++){tmp_el=dialog.accordionHeaders[i];elh=this.getInnerSize(tmp_el).h+this.getVal(tmp_el.css('borderTopWidth'))+this.getVal(tmp_el.css('borderBottomWidth'))+this.getVal(tmp_el.css('paddingTop'))+this.getVal(tmp_el.css('paddingBottom'))+this.getVal(tmp_el.css('marginTop'))+this.getVal(tmp_el.css('marginBottom'));if(maxHeight<elh)maxHeight=elh;var trgt=tmp_el.data('targetSheet');tmp_el=dialog.wrap[trgt];elh=this.getInnerSize(tmp_el).h+this.getVal(tmp_el.css('borderTopWidth'))+this.getVal(tmp_el.css('borderBottomWidth'))+this.getVal(tmp_el.css('marginTop'))+this.getVal(tmp_el.css('marginBottom'));if(typeof opts.bodyCss.height!="undefined")elh+=+this.getVal(dialog.accordionBodies[trgt].css('paddingTop'))+this.getVal(dialog.accordionBodies[trgt].css('paddingBottom'));if(maxHeight<elh)maxHeight=elh}for(var i=0;i<dialog.accordionSeparators.length;i++){tmp_el=dialog.accordionSeparators[i];elh=this.getInnerSize(tmp_el).h+this.getVal(tmp_el.css('borderTopWidth'))+this.getVal(tmp_el.css('borderBottomWidth'))+this.getVal(tmp_el.css('paddingTop'))+this.getVal(tmp_el.css('paddingBottom'))+this.getVal(tmp_el.css('marginTop'))+this.getVal(tmp_el.css('marginBottom'));if(maxHeight<elh)maxHeight=elh}ch=maxHeight+_ph}ph=ch-_ph;if(dialog.wrap.length>0){wh=ph-(this.getVal(tmpW.css("paddingTop"))+this.getVal(tmpW.css("paddingBottom"))+this.getVal(tmpW.css("marginTop"))+this.getVal(tmpW.css("marginBottom"))+this.getVal(tmpW.css("borderTopWidth"))+this.getVal(tmpW.css("borderBottomWidth")));hh=ph-(this.getVal(dialog.accordionHeaders[0].css("paddingTop"))+this.getVal(dialog.accordionHeaders[0].css("paddingBottom"))+this.getVal(dialog.accordionHeaders[0].css("marginTop"))+this.getVal(dialog.accordionHeaders[0].css("marginBottom"))+this.getVal(dialog.accordionHeaders[0].css("borderTopWidth"))+this.getVal(dialog.accordionHeaders[0].css("borderBottomWidth")));if(ieQuirks){wh+=this.getVal(tmpW.css("borderTopWidth"))+this.getVal(tmpW.css("borderBottomWidth"));ph+=this.getVal(dialog.paneContainer[0].css("paddingTop"))+this.getVal(dialog.paneContainer[0].css("paddingBottom"))+this.getVal(dialog.paneContainer[0].css("borderTopWidth"))+this.getVal(dialog.paneContainer[0].css("borderBottomWidth"));if(opts.singleContainer)ch+=this.getVal(dialog.container.css("paddingTop"))+this.getVal(dialog.container.css("paddingBottom"))+this.getVal(dialog.container.css("borderTopWidth"))+this.getVal(dialog.container.css("borderBottomWidth"))}}else{wh=hh=ph}for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i].css('height',wh);dialog.paneContainer[i].css('height',ph);dialog.accordionHeaders[i].css('height',hh);dialog.accordionBodies[i].css('height','')}if(opts.singleContainer)dialog.container.css('height',ch);var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.header.separatorCss);var tmp1=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);if(ieQuirks){opts.header.separatorCss.height=ph-(self.getVal(tmp.css('marginTop'))+self.getVal(tmp.css('marginBottom')))}else{opts.header.separatorCss.height=ph-(self.getVal(tmp.css('paddingTop'))+self.getVal(tmp.css('paddingBottom'))+self.getVal(tmp.css('marginTop'))+self.getVal(tmp.css('marginBottom'))+self.getVal(tmp.css('borderTopWidth'))+self.getVal(tmp.css('borderBottomWidth')))}opts.header.separatorCss.height+=self.getVal(tmp1.css('marginTop'))+self.getVal(tmp1.css('marginBottom'));tmp1.remove();tmp.remove();$.each([opts.header.normalCss,opts.header.normalOverCss,opts.header.selectedCss,opts.header.selectedOverCss],function(i,el){var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(el);if(ieQuirks){el.height=ph-_ph-(self.getVal(tmp.css('marginTop'))+self.getVal(tmp.css('marginBottom')))}else{el.height=ph-(self.getVal(tmp.css('marginTop'))+self.getVal(tmp.css('marginBottom'))+self.getVal(tmp.css('borderTopWidth'))+self.getVal(tmp.css('borderBottomWidth')));if(!opts.header.backgroundImages.show)el.height-=self.getVal(tmp.css('paddingTop'))+self.getVal(tmp.css('paddingBottom'))}tmp.remove()});for(var i=0;i<dialog.wrap.length;i++){dialog.accordionBodies[i].css({'display':((ie6||ieQuirks)?'inline':'inline-block'),'float':'left','clear':''});dialog.wrap[i].css({'display':((ie6||ieQuirks)?'inline':'inline-block'),'float':'left','clear':''});dialog.paneContainer[i].css({'display':((ie6||ieQuirks)?'inline':'inline-block'),'float':'left','clear':''})}for(var i=0;i<dialog.accordionBodies.length;i++){if(dialog.accordionBodies[i].height()+_bh>dialog.wrap[i].height()){dialog.accordionBodies[i].css({'width':this.getVal(dialog.accordionBodies[i].css('width'))-self.getScrollbarWidth()})}}for(var i=0;i<dialog.accordionSeparators.length;i++)dialog.accordionSeparators[i].css(opts.header.separatorCss)},setVerticalDimensions:function(){var ch=0,cw=0,wh=0,ww=0,bh=0,bw=0,hh=0,hw=0,ph=0,pw=0;var _ch=0,_cw=0,_wh=0,_ww=0,_bh=0,_bw=0,_hh=0,_hw=0,_sh=0,_sw=0;var totalHeaderSize=0,IE8ItalicFix=0,maxWidth=0,maxHeight=0,IE6MarginFix=0;var tmpW=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.wrapCss),tmpB=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.bodyCss);if(dialog.wrap.length>0){IE8ItalicFix=((tmpW.css('font-style')=="italic"||tmpW.css('font-style')=="oblique")&&$.browser.msie&&parseInt($.browser.version.substring(0,1))>5)?parseInt(this.getVal(tmpW.css('font-size'))/3):0;_wh=this.getVal(tmpW.css('borderTopWidth'))+this.getVal(tmpW.css('borderBottomWidth'))+this.getVal(tmpW.css('marginTop'))+this.getVal(tmpW.css('marginBottom'));_ww=this.getVal(tmpW.css('borderLeftWidth'))+this.getVal(tmpW.css('borderRightWidth'))+this.getVal(tmpW.css('marginLeft'))+this.getVal(tmpW.css('marginRight'));_bh=this.getVal(tmpB.css('paddingTop'))+this.getVal(tmpB.css('paddingBottom'));_bw=this.getVal(tmpB.css('paddingLeft'))+this.getVal(tmpB.css('paddingRight'))}var tmp_p=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);_pw=this.getVal(tmp_p.css("paddingLeft"))+this.getVal(tmp_p.css("paddingRight"))+this.getVal(tmp_p.css("marginLeft"))+this.getVal(tmp_p.css("marginRight"))+this.getVal(tmp_p.css("borderLeftWidth"))+this.getVal(tmp_p.css("borderRightWidth"));tmp_p.remove();if(typeof opts.paneCss.width!="undefined"){cw=this.getVal(opts.paneCss.width)+_pw}else if(typeof opts.containerCss.width!="undefined"&&opts.singleContainer){cw=this.getVal(opts.containerCss.width)}else{if(!$.browser.msie){var tmp_el,elh;for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){tmp_el=dialog.accordionHeadersSeparators[i];elh=this.getInnerSize(tmp_el).w+this.getVal(tmp_el.css('borderLeftWidth'))+this.getVal(tmp_el.css('borderRightWidth'))+this.getVal(tmp_el.css('paddingLeft'))+this.getVal(tmp_el.css('paddingRight'))+this.getVal(tmp_el.css('marginLeft'))+this.getVal(tmp_el.css('marginRight'));if(maxWidth<elh)maxWidth=elh;if(!dialog.accordionHeadersSeparators[i].data("isSeparator")){var trgt=tmp_el.data('targetSheet');tmp_el=dialog.wrap[trgt];elh=this.getInnerSize(tmp_el).w+this.getVal(tmp_el.css('borderLeftWidth'))+this.getVal(tmp_el.css('borderRightWidth'))+this.getVal(tmp_el.css('marginLeft'))+this.getVal(tmp_el.css('marginRight'));if(typeof opts.bodyCss.width!="undefined")elh+=+this.getVal(dialog.accordionBodies[trgt].css('paddingLeft'))+this.getVal(dialog.accordionBodies[trgt].css('paddingRight'));if(maxWidth<elh)maxWidth=elh}}cw=maxWidth+_pw}else{for(var i=0;i<dialog.wrap.length;i++)dialog.wrap[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.accordionHeaders.length;i++)dialog.accordionHeaders[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.accordionSeparators.length;i++)dialog.accordionSeparators[i].css({'display':'none','float':'none'});for(var i=0;i<dialog.paneContainer.length;i++)dialog.paneContainer[i].css({'display':'none','float':'none'});var tmp=$("<span style='font-size: 1px;'>&nbsp;</span>");dialog.container.append(tmp);cw=(ieQuirks)?dialog.container.innerWidth():dialog.container.outerWidth();tmp.remove();cw-=this.getVal(dialog.container.css('paddingLeft'))+this.getVal(dialog.container.css('paddingRight'));if(!ieQuirks)cw-=this.getVal(dialog.container.css('borderLeftWidth'))+this.getVal(dialog.container.css('borderRightWidth'));for(var i=0;i<dialog.paneContainer.length;i++)dialog.paneContainer[i].css({'display':'block','float':'none'});for(var i=0;i<dialog.wrap.length;i++)dialog.wrap[i].css({'display':'block','float':'none'});for(var i=0;i<dialog.accordionHeaders.length;i++)dialog.accordionHeaders[i].css({'display':'block','float':'none'});for(var i=0;i<dialog.accordionSeparators.length;i++)dialog.accordionSeparators[i].css({'display':'block','float':'none'})}}pw=cw-_pw;if(dialog.wrap.length>0){ww=pw-(this.getVal(tmpW.css("paddingLeft"))+this.getVal(tmpW.css("paddingRight"))+this.getVal(tmpW.css("marginLeft"))+this.getVal(tmpW.css("marginRight"))+this.getVal(tmpW.css("borderLeftWidth"))+this.getVal(tmpW.css("borderRightWidth")))}else{ww=pw}bw=ww-_bw;if(dialog.wrap.length>0){if(ieQuirks){bw=ww;ww+=this.getVal(tmpW.css("borderLeftWidth"))+this.getVal(tmpW.css("borderRightWidth"));pw+=this.getVal(dialog.paneContainer[0].css("paddingLeft"))+this.getVal(dialog.paneContainer[0].css("paddingRight"))+this.getVal(dialog.paneContainer[0].css("borderLeftWidth"))+this.getVal(dialog.paneContainer[0].css("borderRightWidth"));if(opts.singleContainer)cw+=this.getVal(dialog.container.css("paddingLeft"))+this.getVal(dialog.container.css("paddingRight"))+this.getVal(dialog.container.css("borderLeftWidth"))+this.getVal(dialog.container.css("borderRightWidth"))}}for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i].css('width',ww);dialog.paneContainer[i].css('width',pw);dialog.accordionBodies[i].css('width',bw-IE8ItalicFix)}if(opts.singleContainer)dialog.container.css('width',cw);var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.header.separatorCss);var tmp1=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);if(ieQuirks){opts.header.separatorCss.width=pw-(self.getVal(tmp.css('marginLeft'))+self.getVal(tmp.css('marginRight')))}else{opts.header.separatorCss.width=pw-(self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'))+self.getVal(tmp.css('marginLeft'))+self.getVal(tmp.css('marginRight'))+self.getVal(tmp.css('borderLeftWidth'))+self.getVal(tmp.css('borderRightWidth')))}opts.header.separatorCss.width+=self.getVal(tmp1.css('marginLeft'))+self.getVal(tmp1.css('marginRight'));tmp1.remove();tmp.remove();$.each([opts.header.normalCss,opts.header.normalOverCss,opts.header.selectedCss,opts.header.selectedOverCss],function(i,el){var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(el);var tmp1=$("<div>&nbsp;</div>").css("line-height","0px").css(opts.paneCss);if(ieQuirks){el.width=pw-_pw-(self.getVal(tmp.css('marginLeft'))+self.getVal(tmp.css('marginRight')))+(self.getVal(tmp1.css('marginLeft'))+self.getVal(tmp1.css('marginRight')))}else{el.width=pw-(self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'))+self.getVal(tmp.css('marginLeft'))+self.getVal(tmp.css('marginRight'))+self.getVal(tmp.css('borderLeftWidth'))+self.getVal(tmp.css('borderRightWidth')));if(opts.header.backgroundImages.show)el.width+=self.getVal(tmp.css('paddingLeft'))+self.getVal(tmp.css('paddingRight'))}tmp.remove();tmp1.remove()});for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){dialog.accordionHeadersSeparators[i].css("display","block");if(!dialog.accordionHeadersSeparators[i].data("isSeparator")){self.setHeaderStyle(dialog.accordionHeaders[dialog.accordionHeadersSeparators[i].data('headerno')],false,false);dialog.wrap[dialog.accordionHeadersSeparators[i].data('targetSheet')].hide()}}if(typeof opts.paneCss.height!="undefined"){for(var i=0;i<dialog.accordionBodies.length;i++){wh=this.getVal(opts.paneCss.height)-(dialog.accordionHeaders[i].outerHeight()+_wh);if(ieQuirks){wh=wh+_wh;bh=wh-_wh}else{bh=wh-_bh}dialog.wrap[i].css({height:wh});dialog.accordionBodies[i].css('height','');dialog.paneContainer[i].css('height','')}}else{if(opts.singleContainer){ch=dialog.container.innerHeight();_ch=this.getVal(dialog.container.css('borderTopWidth'))+this.getVal(dialog.container.css('borderBottomWidth'))+this.getVal(dialog.container.css('paddingTop'))+this.getVal(dialog.container.css('paddingBottom'));if(ieQuirks){ch+=_ch}dialog.container.css('height','');totalHeaderSize=dialog.container.innerHeight();if(typeof opts.containerCss.height!="undefined"){wh=ch-totalHeaderSize;if(ieQuirks){wh=wh-_ch;bh=wh-_wh}else{wh=wh-_wh;bh=wh-_bh}}else if(typeof opts.bodyCss.height!="undefined"){bh=this.getVal(opts.bodyCss.height)+_bh;if(ieQuirks){bh=bh;wh=bh+_wh;ch=wh+totalHeaderSize+_wh}else{bh=bh-_bh;wh=bh+_bh;ch=wh+totalHeaderSize+_wh}}else{if(opts.fixedHeight){for(var i=0;i<dialog.wrap.length;i++){if(maxHeight<dialog.wrap[i].height())maxHeight=dialog.wrap[i].height()}wh=maxHeight;if(ieQuirks){wh+=_wh}}}for(var i=0;i<dialog.accordionBodies.length;i++){dialog.wrap[i].css({'height':wh>0?wh:''});dialog.paneContainer[i].css({'height':''})}}else{for(var i=0;i<dialog.accordionBodies.length;i++){if(typeof opts.bodyCss.height=="undefined"){dialog.wrap[i].show();bh=this.getInnerSize(dialog.accordionBodies[i]).h;if(ie6&&!ieQuirks)bh-=this.getVal(dialog.wrap[i].css('borderBottomWidth'));if(ieQuirks)bh+=this.getVal(dialog.accordionBodies[i].css('paddingTop'))+this.getVal(dialog.accordionBodies[i].css('paddingBottom'))}else{bh=this.getVal(opts.bodyCss.height);if(ieQuirks)bh+=_bh}if(ieQuirks){wh=bh+_wh-(this.getVal(dialog.wrap[i].css('marginTop'))+this.getVal(dialog.wrap[i].css('marginBottom')))}else{wh=bh+_bh}if(maxHeight<wh)maxHeight=wh;dialog.wrap[i].css({'height':wh});dialog.accordionBodies[i].css({'height':''})}if(opts.fixedHeight){for(var i=0;i<dialog.accordionBodies.length;i++)dialog.wrap[i].css({'height':maxHeight})}}}if(opts.singleContainer)dialog.container.css({'height':'','display':'inline-block'});if(ieQuirks){for(var i=0;i<dialog.accordionHeaders.length;i++){if(typeof dialog.accordionHeaders[i].data('customOptions')!="undefined"){$.each([dialog.accordionHeaders[i].data('customOptions').normalCss,dialog.accordionHeaders[i].data('customOptions').normalOverCss,dialog.accordionHeaders[i].data('customOptions').selectedCss,dialog.accordionHeaders[i].data('customOptions').selectedOverCss],function(i,el){if(typeof el!="undefined"&&typeof el.height!="undefined"){var tmp=$("<div>&nbsp;</div>").css("line-height","0px").css(el);el.height=self.getVal(el.height)+self.getVal(tmp.css('paddingTop'))+self.getVal(tmp.css('paddingBottom'))+self.getVal(tmp.css('borderTopWidth'))+self.getVal(tmp.css('borderBottomWidth'));tmp.remove()}})}}}for(var i=0;i<dialog.wrap.length;i++){dialog.accordionHeaders[i].css({'display':((ie6||ieQuirks)?'inline-block':'block')});dialog.accordionBodies[i].css({'display':((ie6||ieQuirks)?'inline-block':'block')});dialog.wrap[i].css({'display':((ie6||ieQuirks)?'inline-block':'block')});dialog.paneContainer[i].css({'display':((ie6||ieQuirks)?'inline-block':'block')});if(dialog.accordionBodies[i].height()+_bh>dialog.wrap[i].height()){dialog.wrap[i].css({"overflow":"auto"});dialog.accordionBodies[i].css({'width':this.getVal(dialog.accordionBodies[i].css('width'))-self.getScrollbarWidth()})}}for(var i=0;i<dialog.accordionSeparators.length;i++){dialog.accordionSeparators[i].css(opts.header.separatorCss).css({'display':((ie6||ieQuirks)?'inline-block':'block')})}},getDelay:function(x){if(typeof x=="number")return x;else if(typeof x=="string")return parseInt(x);else if(typeof x=="object"){if(typeof x.duration=="number")return x.duration;else if(typeof x.duration=="string")return parseInt(x.duration);else return 0}else return 0},addItem:function(){},addSingleBody:function(){},addBodies:function(){},addSingleHead:function(data,options,targetSheet,styleHeader,blendOptions){if(typeof styleHeader=="undefined")styleHeader=opts.header.styleHeaders;if(typeof blendOptions=="undefined")blendOptions=true;if(typeof targetSheet=="undefined")targetSheet=dialog.accordionHeaders.length<dialog.accordionBodies.length?dialog.accordionHeaders.length:dialog.accordionBodies.length;if(typeof data=='object'&&typeof(data.jquery)=="string"&&data.length){var cur=dialog.accordionHeaders.length;dialog.accordionHeaders[cur]=$(data);if(options){if(blendOptions)dialog.accordionHeaders[cur].data('customOptions',$.extend(true,{},opts.header,options));else dialog.accordionHeaders[cur].data('customOptions',options)}var ch=data.children();if(ch.eq(0).is("IMG")){var co={hasImage:true,images:{accordionNormal:'',accordionMouse:'',accordionSelectedNormal:'',accordionSelectedMouse:''}};co.images.accordionNormal=ch.eq(0).attr('src');ch.eq(0).attr('src','').remove();co.image=$("<img style='display: "+((opts.direction=="left"||opts.direction=="right")?"inline-":"")+"block;"+((opts.direction=="left"||opts.direction=="right")?"float: left;":"")+"'/>");co.image.attr('src',co.images.accordionNormal);opts.loadingHeaderImages=true;co.image.load(function(){opts.loadingHeaderImages=false});if(ch.eq(1).is("IMG")){co.images.accordionMouse=ch.eq(1).attr('src');lwac_preload(ch.eq(1).attr('src'));ch.eq(1).attr('src','').remove();if(ch.eq(2).is("IMG")){co.images.accordionSelectedNormal=ch.eq(2).attr('src');lwac_preload(ch.eq(2).attr('src'));ch.eq(2).attr('src','').remove();if(ch.eq(3).is("IMG")){co.images.accordionSelectedMouse=ch.eq(3).attr('src');lwac_preload(ch.eq(3).attr('src'));ch.eq(3).attr('src','').remove()}else co.images.accordionSelectedMouse=co.images.accordionSelectedNormal}else co.images.accordionSelectedMouse=co.images.accordionSelectedNormal=co.images.accordionMouse}else co.images.accordionSelectedMouse=co.images.accordionSelectedNormal=co.images.accordionMouse=co.images.accordionNormal;if(dialog.accordionHeaders[cur].data('customOptions'))dialog.accordionHeaders[cur].data('customOptions',$.extend(true,{},dialog.accordionHeaders[cur].data('customOptions'),co));else dialog.accordionHeaders[cur].data('customOptions',co);dialog.accordionHeaders[cur].prepend(dialog.accordionHeaders[cur].data('customOptions').image)}opts.indicator.normalCss=$.extend(true,{},opts.indicator.commonCss,opts.indicator.normalCss);opts.indicator.normalOverCss=$.extend(true,{},opts.indicator.commonCss,opts.indicator.normalOverCss);opts.indicator.selectedCss=$.extend(true,{},opts.indicator.commonCss,opts.indicator.selectedCss);opts.indicator.selectedOverCss=$.extend(true,{},opts.indicator.commonCss,opts.indicator.selectedOverCss);if(opts.header.backgroundImages.show){dialog.accordionHeaders[cur].backLeft=$("<td style='width: "+opts.header.backgroundImages.closedLeftWidth+"px;' />");dialog.accordionHeaders[cur].backTile=$("<td/>").html(self.myTrim(dialog.accordionHeaders[cur].html())==""?"&nbsp;":dialog.accordionHeaders[cur].html());dialog.accordionHeaders[cur].backRight=$("<td style='width: "+opts.header.backgroundImages.closedRightWidth+"px;' />");var tmp_tbl=$("<table border='0' cellpadding='0' cellspacing='0' "+((opts.direction=="left"||opts.direciton=="right")?"":"width='100%'")+"height='100%'/>").append($("<tr/>").append(dialog.accordionHeaders[cur].backLeft).append(dialog.accordionHeaders[cur].backTile).append(dialog.accordionHeaders[cur].backRight));dialog.accordionHeaders[cur].html(tmp_tbl)}if(styleHeader&&opts.indicator.show){dialog.accordionHeaders[cur].indicator=$("<div>&nbsp;</div>").css("line-height","0px");if(opts.indicator.hasText){dialog.accordionHeaders[cur].indicator.text=$("<div></div>").css("display","inline");dialog.accordionHeaders[cur].indicator.append(dialog.accordionHeaders[cur].indicator.text)}if(opts.indicator.hasImage){dialog.accordionHeaders[cur].indicator.image=$("<img style='display: "+(opts.indicator.hasText?"inline":"block")+"; width:"+opts.indicator.imageWidth+"px; height: "+opts.indicator.imageHeight+"px;'/>");dialog.accordionHeaders[cur].indicator.append(dialog.accordionHeaders[cur].indicator.image)}dialog.accordionHeaders[cur].indicator.data('targetSheet',targetSheet);dialog.accordionHeaders[cur].prepend(dialog.accordionHeaders[cur].indicator);dialog.accordionHeaders[cur].indicator.bind(opts.indicator.trigger,function(event){event.stopPropagation();self.gotoSheet($(this).data('targetSheet'))})}dialog.accordionHeaders[cur].data('targetSheet',targetSheet);if(styleHeader){self.fixHeaderStyles(dialog.accordionHeaders[cur])}if(options&&options.trigger){dialog.accordionHeaders[cur].bind(options.trigger,function(event){event.stopPropagation();self.gotoSheet($(this).data('targetSheet'))})}else{dialog.accordionHeaders[cur].bind(opts.header.trigger,function(event){event.stopPropagation();self.gotoSheet($(this).data('targetSheet'))})}}dialog.accordionHeaders[cur].addClass(opts.classes.headerClass);return self},setHeaderIndicatorStyle:function(header,mouse_over,is_open){var indicator=header.indicator;var midY=((header.outerHeight()-(self.getVal(header.css("borderTopWidth"))+self.getVal(header.css("borderBottomWidth"))+opts.indicator.imageHeight))/2);var midX=((header.outerWidth()-(self.getVal(header.css("borderLeftWidth"))+self.getVal(header.css("borderRightWidth"))+opts.indicator.imageWidth))/2);var tx="",ty="";switch(opts.indicator.positioning){case"top-left":tx=0;ty=0;break;case"top-center":tx=midX;ty=0;break;case"top-right":tx=midX*2;ty=0;break;case"middle-left":tx=0;ty=midY;break;case"middle-center":tx=midX;ty=midY;break;case"middle-right":tx=midX*2;ty=midY;break;case"bottom-left":tx=0;ty=midY*2;break;case"bottom-center":tx=midX;ty=midY*2;break;case"bottom-right":tx=midX*2;ty=midY*2;break}if(mouse_over){if(is_open){if(opts.indicator.hasText)indicator.children('div').html(opts.indicator.selectedOverText);indicator.css(opts.indicator.selectedOverCss);if(opts.indicator.hasImage&&opts.indicator.selectedOverImage!='')indicator.children('img').attr('src',opts.indicator.selectedOverImage)}else{if(opts.indicator.hasText)indicator.children('div').html(opts.indicator.normalOverText);indicator.css(opts.indicator.normalOverCss);if(opts.indicator.hasImage&&opts.indicator.normalOverImage!='')indicator.children('img').attr('src',opts.indicator.normalOverImage)}}else{if(is_open){if(opts.indicator.hasText)indicator.children('div').html(opts.indicator.selectedText);indicator.css(opts.indicator.selectedCss);if(opts.indicator.hasImage&&opts.indicator.selectedImage!='')indicator.children('img').attr('src',opts.indicator.selectedImage)}else{if(opts.indicator.hasText)indicator.children('div').html(opts.indicator.normalText);indicator.css(opts.indicator.normalCss);if(opts.indicator.hasImage&&opts.indicator.normalImage!='')indicator.children('img').attr('src',opts.indicator.normalImage)}}indicator.css({'left':(tx+self.getVal(opts.indicator.selectedOverCss.left))+"px",'top':(ty+self.getVal(opts.indicator.selectedOverCss.top))+"px"})},setHeaderStyle:function(header,mouse_over,is_open){if(mouse_over){if(is_open){if(header.data('customOptions')&&header.data('customOptions').selectedOverCss)header.css(header.data('customOptions').selectedOverCss);else header.css(opts.header.selectedOverCss);if(header.data('customOptions')&&header.data('customOptions').hasImage&&header.data('customOptions').images.accordionSelectedMouse&&header.data('customOptions').images.accordionSelectedMouse!='')header.children().eq(0).attr('src',header.data('customOptions').images.accordionSelectedMouse);else if(opts.header.hasImage&&opts.header.images.accordionSelectedMouse!='')header.children().eq(0).attr('src',opts.header.images.accordionSelectedMouse)}else{if(header.data('customOptions')&&header.data('customOptions').normalOverCss)header.css(header.data('customOptions').normalOverCss);else header.css(opts.header.normalOverCss);if(header.data('customOptions')&&header.data('customOptions').hasImage&&header.data('customOptions').images.accordionMouse&&header.data('customOptions').images.accordionMouse!='')header.children().eq(0).attr('src',header.data('customOptions').images.accordionMouse);else if(opts.header.hasImage&&opts.header.images.accordionMouse!='')header.children().eq(0).attr('src',opts.header.images.accordionMouse)}}else{if(is_open){if(header.data('customOptions')&&header.data('customOptions').selectedCss)header.css(header.data('customOptions').selectedCss);else header.css(opts.header.selectedCss);if(header.data('customOptions')&&header.data('customOptions').hasImage&&header.data('customOptions').images.accordionSelectedNormal&&header.data('customOptions').images.accordionSelectedNormal!='')header.children().eq(0).attr('src',header.data('customOptions').images.accordionSelectedNormal);else if(opts.header.hasImage&&opts.header.images.accordionSelectedNormal!='')header.children().eq(0).attr('src',opts.header.images.accordionSelectedNormal)}else{if(header.data('customOptions')&&header.data('customOptions').normalCss)header.css(header.data('customOptions').normalCss);else header.css(opts.header.normalCss);if(header.data('customOptions')&&header.data('customOptions').hasImage&&header.data('customOptions').images.accordionNormal&&header.data('customOptions').images.accordionNormal!='')header.children().eq(0).attr('src',header.data('customOptions').images.accordionNormal);else if(opts.header.hasImage&&opts.header.images.accordionNormal!='')header.children().eq(0).attr('src',opts.header.images.accordionNormal)}}if(opts.header.backgroundImages.show){header.backLeft.css({'background-image':'url('+eval("opts.header.backgroundImages."+(is_open?"open":"closed")+(mouse_over?"Over":"")+"Left")+')','width':eval("opts.header.backgroundImages."+(is_open?"open":"closed")+(mouse_over?"Over":"")+"LeftWidth")});header.backTile.css({'background-image':'url('+eval("opts.header.backgroundImages."+(is_open?"open":"closed")+(mouse_over?"Over":"")+"Tile")+')'});header.backRight.css({'background-image':'url('+eval("opts.header.backgroundImages."+(is_open?"open":"closed")+(mouse_over?"Over":"")+"Right")+')','width':eval("opts.header.backgroundImages."+(is_open?"open":"closed")+(mouse_over?"Over":"")+"RightWidth")});var c={};$.each(["paddingLeft","paddingRight","paddingTop","paddingBottom","fontWeight","fontStyle","fontSize","fontFamily","color"],function(i,el){eval("c."+el+"=header.css('"+el+"');")});header.css('padding','0px');header.backTile.css(c)}},setFixedHeaderWidth:function(header){if(header.data("isWidthFixed"))return;header.data("isWidthFixed",true);var maxWidth=0,w=0;self.setHeaderStyle(header,false,false);header.find("img").each(function(){$(this).data("myfloat",$(this).css("float"));$(this).css("float","")});if(maxWidth<header.outerWidth())maxWidth=header.outerWidth();self.setHeaderStyle(header,false,true);if(maxWidth<header.outerWidth())maxWidth=header.outerWidth();self.setHeaderStyle(header,true,false);if(maxWidth<header.outerWidth())maxWidth=header.outerWidth();self.setHeaderStyle(header,true,true);if(maxWidth<header.outerWidth())maxWidth=header.outerWidth();self.setHeaderStyle(header,false,false);w=this.getVal(header.css('marginLeft'))+this.getVal(header.css('marginRight'));if(!(ieQuirks))w+=this.getVal(header.css('borderLeftWidth'))+this.getVal(header.css('borderRightWidth'))+this.getVal(header.css('paddingLeft'))+this.getVal(header.css('paddingRight'));opts.header.normalCss.width=(maxWidth-w)+"px";self.setHeaderStyle(header,false,true);w=this.getVal(header.css('marginLeft'))+this.getVal(header.css('marginRight'));if(!(ieQuirks))w+=this.getVal(header.css('borderLeftWidth'))+this.getVal(header.css('borderRightWidth'))+this.getVal(header.css('paddingLeft'))+this.getVal(header.css('paddingRight'));opts.header.normalOverCss.width=(maxWidth-w)+"px";self.setHeaderStyle(header,true,false);w=this.getVal(header.css('marginLeft'))+this.getVal(header.css('marginRight'));if(!(ieQuirks))w+=this.getVal(header.css('borderLeftWidth'))+this.getVal(header.css('borderRightWidth'))+this.getVal(header.css('paddingLeft'))+this.getVal(header.css('paddingRight'));opts.header.selectedCss.width=(maxWidth-w)+"px";self.setHeaderStyle(header,true,true);w=this.getVal(header.css('marginLeft'))+this.getVal(header.css('marginRight'));if(!(ieQuirks))w+=this.getVal(header.css('borderLeftWidth'))+this.getVal(header.css('borderRightWidth'))+this.getVal(header.css('paddingLeft'))+this.getVal(header.css('paddingRight'));opts.header.selectedOverCss.width=(maxWidth-w)+"px";header.children("table").css('width','100%')},addHeads:function(data,options,styleHeaders,styleCurrentHeader){if(typeof styleHeaders=="undefined")styleHeaders=true;if(typeof styleCurrentHeader=="undefined")styleCurrentHeader=true;if(typeof data=='object'&&typeof(data.jquery)=="string"&&data.length){opts.header=$.extend(true,{},opts.header,options);var tmpHeads=lQuery.makeArray(data);for(var i=0;i<tmpHeads.length;i++){self.addSingleHead(data.eq(i),null,i,styleHeaders,styleCurrentHeader)}}return self},fixHeaderStyles:function(header){header.mouseover(function(){clearTimeout(header.styleTimer);header.styleTimer=setTimeout(function(){self.setHeaderStyle(header,true,dialog.wrap[header.data('targetSheet')].data('isOpen'));if(opts.indicator.show)self.setHeaderIndicatorStyle(header,true,dialog.wrap[header.data('targetSheet')].data('isOpen'))},10)});header.mouseout(function(){clearTimeout(header.styleTimer);header.styleTimer=setTimeout(function(){self.setHeaderStyle(header,false,dialog.wrap[header.data('targetSheet')].data('isOpen'));if(opts.indicator.show)self.setHeaderIndicatorStyle(header,false,dialog.wrap[header.data('targetSheet')].data('isOpen'))},10)});if(dialog.currentSheet==header.data('targetSheet')){if(header.data('customOptions')&&header.data('customOptions').selectedCss)header.css(header.data('customOptions').selectedCss);else header.css(opts.header.selectedCss);if(opts.indicator.show)header.indicator.css(opts.indicator.selectedCss)}else{if(header.data('customOptions')&&header.data('customOptions').normalCss)header.css(header.data('customOptions').normalCss);else header.css(opts.header.normalCss);if(opts.indicator.show)header.indicator.css(opts.indicator.normalCss)}}});if(typeof options=="number")options={currentSheet:options};opts=$.extend(true,{},$.liknoAccordion.defaults,options);if(typeof options=="object")if(typeof options.transition=="object")if(typeof options.transition.transWhat=="object")opts.transition.transWhat=options.transition.transWhat;var isEmpty=true;isEmpty=true;for(var x in opts.transition.transWhat){isEmpty=false}if(isEmpty)opts.transition.transWhat={height:"show"};if(typeof opts.bodyCss=="object"){opts.wrapCss=opts.bodyCss;opts.bodyCss={};if(typeof opts.wrapCss.height!="undefined"){opts.bodyCss.height=opts.wrapCss.height}if(typeof opts.wrapCss.width!="undefined"){opts.bodyCss.width=opts.wrapCss.width}if(typeof opts.wrapCss.padding!="undefined"){opts.bodyCss.padding=opts.wrapCss.padding;opts.wrapCss.padding=0}if(typeof opts.wrapCss.paddingLeft!="undefined"){opts.bodyCss.paddingLeft=opts.wrapCss.paddingLeft;opts.wrapCss.paddingLeft=0}if(typeof opts.wrapCss.paddingRight!="undefined"){opts.bodyCss.paddingRight=opts.wrapCss.paddingRight;opts.wrapCss.paddingRight=0}if(typeof opts.wrapCss.paddingTop!="undefined"){opts.bodyCss.paddingTop=opts.wrapCss.paddingTop;opts.wrapCss.paddingTop=0}if(typeof opts.wrapCss.paddingBottom!="undefined"){opts.bodyCss.paddingBottom=opts.wrapCss.paddingBottom;opts.wrapCss.paddingBottom=0}}opts.header.normalCss=$.extend(true,{},opts.header.commonCss,opts.header.normalCss);opts.header.normalOverCss=$.extend(true,{},opts.header.commonCss,opts.header.normalOverCss);opts.header.selectedCss=$.extend(true,{},opts.header.commonCss,opts.header.selectedCss);opts.header.selectedOverCss=$.extend(true,{},opts.header.commonCss,opts.header.selectedOverCss);if(opts.header.backgroundImages.show){}if(opts.direction=="left"||opts.direciton=="right"){opts.paneCss.float="left";opts.header.normalCss.float="left";opts.header.normalOverCss.float="left";opts.header.selectedCss.float="left";opts.header.selectedOverCss.float="left";opts.header.separatorCss.float="left";opts.wrapCss.float="left"}if(eval('typeof ('+opts.accordionNameNormal+'_selected_pane)')=="number")opts.currentSheet=eval(opts.accordionNameNormal+'_selected_pane')-1;var tmp=document.location.href;if(tmp.indexOf("#")>-1){tmp=tmp.substr(tmp.indexOf("#")+1);var t_arr=tmp.split("#");for(var i=0;i<t_arr.length;i++){if(t_arr[i].indexOf(opts.accordionNameNormal+'_')==0||t_arr[i].indexOf(opts.accordionName+'_')==0){var t1;if(t_arr[i].indexOf(opts.accordionNameNormal+'_')==0)t1=t_arr[i].substr(t_arr[i].indexOf(opts.accordionNameNormal+'_')+opts.accordionNameNormal.length+1);else t1=t_arr[i].substr(t_arr[i].indexOf(opts.accordionName+'_')+opts.accordionName.length+1);var t2=t1.split('_');if(t2.length==1||t2.length==2){if(!isNaN(Number(t2[0]))){opts.currentSheet=t2[0]-1;if(t2.length==2&&t2[1]=="scroll")opts.getFocus=true}}}}}zIndex=opts.zIndex;dialog.accordionBodies=[];dialog.accordionHeaders=[];dialog.accordionSeparators=[];dialog.accordionHeadersSeparators=[];if(typeof data=='string'){if(data=="")data=$("body");else data=$(data)}var tmpHeads;if(typeof data=='object'&&typeof(data.jquery)=="string"&&data.length){if(data.is("DIV")||data.is("BODY")){if(data.eq(0).hasClass(opts.classes.bodyClass)){dialog.accordionBodies=lQuery.makeArray(data);tmpHeads=lQuery.makeArray();dialog.accordionSeparators=lQuery.makeArray();dialog.accordionHeadersSeparators=lQuery.makeArray()}else{tmpHeads=lQuery.makeArray($(data).find("."+opts.classes.headerClass));dialog.accordionBodies=lQuery.makeArray($(data).find("."+opts.classes.bodyClass));dialog.accordionSeparators=lQuery.makeArray($(data).find("."+opts.classes.separatorClass));dialog.accordionHeadersSeparators=lQuery.makeArray($(data).find("."+opts.classes.headerClass+",."+opts.classes.separatorClass))}}else if($(data).is("UL")){var all=$(data).children("LI");if($(data).parent().length>0){all.insertBefore($(data));$(data).remove()}all=lQuery.makeArray(all);var isHeader=true;var th=[];var tb=[];var ts=[];var ths=[];for(var i=0;i<all.length;i++){if(isHeader){if(self.myTrim(all[i].innerHTML.toLowerCase()).substr(0,11)!="[separator]"){isHeader=false;th[th.length]=$("<div></div>").html(all[i].innerHTML);ths[ths.length]=th[th.length-1];$(th[th.length-1]).insertBefore($(all[i]))}else{ts[ts.length]=$("<div></div>").html(all[i].innerHTML);ths[ths.length]=ts[ts.length-1];$(ts[ts.length-1]).insertBefore($(all[i]))}}else{tb[tb.length]=$("<div></div>").html(all[i].innerHTML);if($(all[i]).attr("externalUrl")){tb[tb.length-1].attr("externalUrl",$(all[i]).attr("externalUrl"));tb[tb.length-1].css('height',200)}if($(all[i]).attr("ajaxUrl"))tb[tb.length-1].attr("ajaxUrl",$(all[i]).attr("ajaxUrl"));$(tb[tb.length-1]).insertBefore($(all[i]));isHeader=true}}for(var i=0;i<all.length;i++)$(all[i]).remove();tmpHeads=$(th);dialog.accordionBodies=$(tb);dialog.accordionSeparators=$(ts);dialog.accordionHeadersSeparators=$(ths)}else{alert('Likno Web Accordion Builder Error: Unsupported tag type <'+data[0].tagName+'>.');return null}for(var i=0;i<tmpHeads.length;i++){self.addSingleHead($(tmpHeads[i]),null,i)}for(var i=0;i<dialog.accordionSeparators.length;i++){dialog.accordionSeparators[i]=$(dialog.accordionSeparators[i]);dialog.accordionSeparators[i].css(opts.header.separatorCss);if(opts.header.backgroundImages.show){dialog.accordionSeparators[i].backLeft=$("<td style='width: "+opts.header.backgroundImages.separatorLeftWidth+"px;' />");dialog.accordionSeparators[i].backTile=$("<td/>").html(self.myTrim(dialog.accordionSeparators[i].html())==""?"&nbsp;":dialog.accordionSeparators[i].html());dialog.accordionSeparators[i].backRight=$("<td style='width: "+opts.header.backgroundImages.separatorRightWidth+"px;' />");var tmp_tbl=$("<table border='0' cellpadding='0' cellspacing='0' "+((opts.direction=="left"||opts.direciton=="right")?"":"width='100%'")+"height='100%'/>").append($("<tr/>").append(dialog.accordionSeparators[i].backLeft).append(dialog.accordionSeparators[i].backTile).append(dialog.accordionSeparators[i].backRight));dialog.accordionSeparators[i].html(tmp_tbl);dialog.accordionSeparators[i].backLeft.css({'background-image':'url('+opts.header.backgroundImages.separatorLeft+')'});dialog.accordionSeparators[i].backTile.css({'background-image':'url('+opts.header.backgroundImages.separatorTile+')'});dialog.accordionSeparators[i].backRight.css({'background-image':'url('+opts.header.backgroundImages.separatorRight+')'});if(ieCM){}}}for(var i=0;i<dialog.accordionBodies.length;i++){dialog.accordionBodies[i]=$(dialog.accordionBodies[i]);dialog.accordionBodies[i].css($.extend({},opts.bodyCss)).addClass(opts.classes.bodyClass);if(typeof(dialog.accordionBodies[i].attr('externalUrl'))!="undefined"||typeof(dialog.accordionBodies[i].attr('ajaxUrl'))!="undefined"){dialog.accordionBodies[i].data("isLoaded",false)}else{dialog.accordionBodies[i].data("isLoaded",true);if(dialog.accordionBodies[i].children("img").length==dialog.accordionBodies[i].children("*").length&&dialog.accordionBodies[i].children("*").length>0){dialog.accordionBodies[i].data("isLoaded",false);dialog.accordionBodies[i].data("isImage",true);dialog.accordionBodies[i].children("img").css('vertical-align','middle')}}}for(var i=0;i<dialog.accordionSeparators.length;i++){dialog.accordionSeparators[i]=$(dialog.accordionSeparators[i]);dialog.accordionSeparators[i].html(self.myTrim(dialog.accordionSeparators[i].html()).replace(/\[[s][e][p][a][r][a][t][o][r]\]/gi,""));dialog.accordionSeparators[i].addClass(opts.classes.separatorClass)}for(var i=0;i<dialog.accordionHeadersSeparators.length;i++){dialog.accordionHeadersSeparators[i]=$(dialog.accordionHeadersSeparators[i]);dialog.accordionHeadersSeparators[i].data("isSeparator",(typeof dialog.accordionHeadersSeparators[i].data("targetSheet")=="undefined")?true:false);for(var j=0;j<dialog.accordionHeaders.length;j++){if(dialog.accordionHeadersSeparators[i][0]===dialog.accordionHeaders[j][0]){dialog.accordionHeadersSeparators[i].data("headerno",j)}}}}else{alert('Likno Web Accordion Builder Error: You have selected the "UL/LI structure" population method for your project, but no such UL/LI structure is found in page.');return null}if(dialog.accordionHeadersSeparators.length==0||dialog.accordionBodies==0){alert('Likno Web Accordion Builder Error: You have selected the "DIV elements" population method for your project, but no DIV elements with the proper "Class" value are found in page for '+(dialog.accordionHeadersSeparators.length==0?"headers":"bodies")+'.');return null}self.createAndStart();return self}if($.browser.msie)$("body").css("background-color",$("body").css("background-color"))})(lQuery);var lwac_imageCache=[];var lwac_imageCacheCounter=0;function lwac_get_background_url(x){if(typeof(x)!="string"||!x||x=='')return'';if(x.indexOf('url(')>-1){x=x.replace(/\'/gi,"").replace(/\"/gi,"").replace(/url/gi,"").replace(/\)/gi,"").replace(/\(/gi,"")}return x}function lwac_preload(_theSrc){lwac_imageCache[lwac_imageCacheCounter]=new Image(1,1);lwac_imageCache[lwac_imageCacheCounter++].src=_theSrc}function lwac_preloadImages(opts){if(typeof opts==="object"){if(typeof opts.ajaxLoadImage==="string")if(opts.ajaxLoadImage!=''){lwac_preload(opts.ajaxLoadImage)}if(typeof opts.bodyCss==="object"){if(typeof opts.bodyCss.backgroundImage==="string")if(opts.bodyCss.backgroundImage!=''){lwac_preload(lwac_get_background_url(opts.bodyCss.backgroundImage))}}if(typeof opts.containerCss==="object"){if(typeof opts.containerCss.backgroundImage==="string")if(opts.containerCss.backgroundImage!=''){lwac_preload(lwac_get_background_url(opts.containerCss.backgroundImage))}}if(typeof opts.header==="object"){if(typeof opts.header.backgroundImages==="object"&&opts.header.backgroundImages.show){lQuery.each(["openLeft","openTile","openRight","closedLeft","closedTile","closedRight","openOverLeft","openOverTile","openOverRight","closedOverLeft","closedOverTile","closedOverRight","separatorLeft","separatorTile","separatorRight"],function(i,el){eval("if (typeof opts.header.backgroundImages."+el+" === 'string') if (typeof opts.header.backgroundImages."+el+" != '') { lwac_preload(opts.header.backgroundImages."+el+"); }")})}lQuery.each(["commonCss","normalCss","normalOverCss","selectedCss","selectedOverCss","separatorCss"],function(i,el){eval("if (typeof opts.header."+el+" === 'object') if (typeof opts.header."+el+".backgroundImage === 'string') if (typeof opts.header."+el+".backgroundImage != '') { lwac_preload(lwac_get_background_url(opts.header."+el+".backgroundImage)); }")})}}}if(typeof nRTC=="undefined")nRTC=function(str){str=lQuery.trim(str);var def=str.split(';');var retArr={};for(i=0;i<def.length;i++){var side=def[i].split(':'),name='',val='';if(def[i]){side[0]=side[0].toLowerCase();if(side.length>2){for(k=2;k<side.length;k++){side[1]+=":"+side[k]}}for(j=0;j<side.length;j++){if(j==0){str=side[j].split('-');var outstr=str[0];for(k=1;k<str.length;k++){outstr=outstr+str[k].charAt(0).toUpperCase()+str[k].substring(1)}name=lQuery.trim(outstr)}else{if(j==1){val=lQuery.trim(side[j])}}}retArr[name]=val}}return retArr};
if (typeof lQuery.easing.easeInQuad == "undefined"){lQuery.easing['jswing']=lQuery.easing['swing'];lQuery.extend(lQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return lQuery.easing[lQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-lQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return lQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return lQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}});}

/*202.2*/